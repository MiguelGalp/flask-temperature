<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>X Temp.</title>
</head>

<body>
{% extends "bootstrap/base.html" %}

{% block content %}
<div class="container">
    <h4 class="pt-4 text-muted" style="margin-top: 30px; margin-left: 2px;">Miss Subtítulos</h4>
    <h3 class="text-uppercase display-2 font-weight-bold" style="margin-top: -7px;"><b>Mapeamos el discurso del odio en twitter en tiempo real</b></h3>
</div>

<div class="container">
    <p style="margin-top: 6px;">--</p>
</div>

<div class="container">
     <h5>Peso relativo de los componentes del odio a las {{ last_fetch_time.last_fetched.strftime('%Y-%m-%d %H:%M:%S') if last_fetch_time else '...' }}</h5>
    {% for user, engagement in user_engagements %}
        {% if user == 'yanilatorre' %}
            {% set user = 'Violencia' %}
        {% elif user == 'SergioChouza' %}
            {% set user = 'Manipulación' %}
        {% elif user == 'atilioboron' %}
            {% set user = 'Venalidad' %}
        {% elif user == 'CarlosMaslaton' %}
            {% set user = 'Banalidad' %}
        {% elif user == 'rialjorge' %}
            {% set user = 'Engaño' %}
        {% elif user == 'alexcaniggia' %}
            {% set user = 'Solipsismo' %}
        {% endif %}
        {% if engagement > 1 %}
            {% set engagement = 1 %}
        {% endif %}
        <div style="width: 100%; background-color: #f3f3f3; border: 1px solid #ccc;">
            <div style="height: 20px; width: {{ "%.2f"|format(engagement*100) }}%; background-color: #007bff;"></div>
        </div>
        <p>{{ user }}</p>
    {% endfor %}
</div>

<div class="container">
    <h5>Peak Occurrences:</h5>
    {% if peak_occurrences %}
        {% for timestamp, engagement in peak_occurrences %}
            <p>{{ timestamp.strftime('%Y-%m-%d %H:%M:%S') }}: {{ engagement }}</p>
        {% endfor %}
    {% else %}
        <p>No peak occurrences in the past 6 hours.</p>
    {% endif %}
</div>

<div class="container">
    <h5>Engagement Level: <span style="color: {% if engagement_level == 'Below Average' %}red{% elif engagement_level == 'Average' %}orange{% else %}green{% endif %};">{{ engagement_level }}</span></h5>
</div>
{% endblock %}


</body>
</html>
