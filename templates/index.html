<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>X Temp.</title>
</head>

<body>
{% extends "bootstrap/base.html" %}

{% block content %}
<div class="container">
    <h4 class="pt-4 text-muted" style="margin-top: 30px; margin-left: 2px;">Miss Subtítulos Pregunta:</h4>
    <h3 class="text-uppercase display-2 font-weight-bold" style="margin-top: -7px;"><b>¿De qué está hecho el odio <kbd>hoy</kbd>?</b></h3>
</div>

<div class="container">
     {% if last_total_increase %}
        {% set now = datetime.now(pytz.timezone('America/Montevideo')) %}
        {% set time_diff = now - last_total_increase.timestamp %}
        {% set minutes_diff = time_diff.total_seconds() // 60 %}
        <h5>Compuestos del odio hace {{ minutes_diff }} minutos</h5>
    {% else %}
        <h5>Compuestos del odio hace ... minutos</h5>
    {% endif %}
    {% for user, engagement in user_engagements %}
        {% if user == 'yanilatorre' %}
            {% set user = 'Violencia' %}
        {% elif user == 'SergioChouza' %}
            {% set user = 'Manipulación' %}
        {% elif user == 'atilioboron' %}
            {% set user = 'Venalidad' %}
        {% elif user == 'CarlosMaslaton' %}
            {% set user = 'Banalidad' %}
        {% elif user == 'rialjorge' %}
            {% set user = 'Engaño' %}
        {% elif user == 'alexcaniggia' %}
            {% set user = 'Solipsismo' %}
        {% endif %}
        {% if engagement > 1 %}
            {% set engagement = 1 %}
        {% endif %}
        <div style="width: 100%; background-color: #f3f3f3; border: 1px solid #ccc;">
            <div style="height: 20px; width: {{ "%.2f"|format(engagement*100) }}%; background-color: #007bff;"></div>
        </div>
        <p>{{ user }}</p>
    {% endfor %}
</div>

<div class="container">
    <h5>Picos de intensidad en el discurso:</h5>
    {% if peak_occurrences %}
        {% for timestamp, engagement in peak_occurrences %}
            <p>{{ timestamp.strftime('%Y-%m-%d %H:%M:%S') }}: {{ engagement }}</p>
        {% endfor %}
    {% else %}
        <p>Sin picos en las últimas 6 horas</p>
    {% endif %}
</div>

<div class="container">
    <h5>Temperatura del discurso: <span style="color: {% if engagement_level == 'Baja' %}green{% elif engagement_level == 'Promedio' %}orange{% else %}red{% endif %};">{{ engagement_level }}</span></h5>
</div>
{% endblock %}


</body>
</html>
